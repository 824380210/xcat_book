# Example for enable the ssh tunnel in Linux Server 

```
iptables -t nat -A POSTROUTING -d 172.16.0.91/32 -p tcp -m tcp -j SNAT --to-source 172.16.0.254
iptables -t nat -A PREROUTING -p tcp -m tcp --dport 21122 -j DNAT --to-destination 172.16.0.91:22
iptables -t nat -A POSTROUTING -o eno4 -j MASQUERADE
echo 1 > /proc/sys/net/ipv4/ip_forward


```
---
# Example of the our test server 
```

iptables -t nat -A POSTROUTING -d 172.16.0.11/32 -p tcp -m tcp -j SNAT --to-source 172.16.0.1
iptables -t nat -A PREROUTING -p tcp -m tcp --dport 21122 -j DNAT --to-destination 172.16.0.11:22
iptables -t nat -A PREROUTING -p tcp -m tcp --dport 55901 -j DNAT --to-destination 172.16.0.11:5901


```
---
# Example of the iptables configure file 

```
[root@xxxx sysconfig]# pwd
/etc/sysconfig
[root@xxxx sysconfig]# cat iptables
# Generated by iptables-save v1.4.21 on Tue Sep 26 17:38:54 2017
*mangle
:PREROUTING ACCEPT [101560732:145874385271]
:INPUT ACCEPT [4766185:6966734269]
:FORWARD ACCEPT [96785635:138907095405]
:OUTPUT ACCEPT [2903183:8043057944]
:POSTROUTING ACCEPT [99688727:146950146053]
-A POSTROUTING -o virbr0 -p udp -m udp --dport 68 -j CHECKSUM --checksum-fill
COMMIT
# Completed on Tue Sep 26 17:38:54 2017
# Generated by iptables-save v1.4.21 on Tue Sep 26 17:38:54 2017
*nat
:PREROUTING ACCEPT [36:6406]
:INPUT ACCEPT [30:6008]
:OUTPUT ACCEPT [1:328]
:POSTROUTING ACCEPT [1:328]
-A PREROUTING -p tcp -m tcp --dport 10122 -j DNAT --to-destination 172.16.0.101:22
-A PREROUTING -p tcp -m tcp --dport 55501 -j DNAT --to-destination 172.16.0.101:5901
-A PREROUTING -p tcp -m tcp --dport 10222 -j DNAT --to-destination 172.16.0.102:22
-A PREROUTING -p tcp -m tcp --dport 55502 -j DNAT --to-destination 172.16.0.102:5901
-A PREROUTING -p tcp -m tcp --dport 10322 -j DNAT --to-destination 172.16.0.103:22
-A PREROUTING -p tcp -m tcp --dport 55503 -j DNAT --to-destination 172.16.0.103:5901
-A PREROUTING -p tcp -m tcp --dport 10422 -j DNAT --to-destination 172.16.0.104:22
-A PREROUTING -p tcp -m tcp --dport 55504 -j DNAT --to-destination 172.16.0.104:5901
-A PREROUTING -p tcp -m tcp --dport 10522 -j DNAT --to-destination 172.16.0.105:22
-A PREROUTING -p tcp -m tcp --dport 55505 -j DNAT --to-destination 172.16.0.105:5901
-A PREROUTING -p tcp -m tcp --dport 10622 -j DNAT --to-destination 172.16.0.106:22
-A PREROUTING -p tcp -m tcp --dport 55506 -j DNAT --to-destination 172.16.0.106:5901
-A PREROUTING -p tcp -m tcp --dport 10722 -j DNAT --to-destination 172.16.0.107:22
-A PREROUTING -p tcp -m tcp --dport 55507 -j DNAT --to-destination 172.16.0.107:5901
-A PREROUTING -p tcp -m tcp --dport 10822 -j DNAT --to-destination 172.16.0.108:22
-A PREROUTING -p tcp -m tcp --dport 55508 -j DNAT --to-destination 172.16.0.108:5901
-A PREROUTING -p tcp -m tcp --dport 10922 -j DNAT --to-destination 172.16.0.109:22
-A PREROUTING -p tcp -m tcp --dport 55509 -j DNAT --to-destination 172.16.0.109:5901
-A PREROUTING -p tcp -m tcp --dport 11022 -j DNAT --to-destination 172.16.0.110:22
-A PREROUTING -p tcp -m tcp --dport 55510 -j DNAT --to-destination 172.16.0.110:5901
-A PREROUTING -p tcp -m tcp --dport 11122 -j DNAT --to-destination 172.16.0.111:22
-A PREROUTING -p tcp -m tcp --dport 55511 -j DNAT --to-destination 172.16.0.111:5901
-A PREROUTING -p tcp -m tcp --dport 11222 -j DNAT --to-destination 172.16.0.112:22
-A PREROUTING -p tcp -m tcp --dport 55512 -j DNAT --to-destination 172.16.0.112:5901
-A PREROUTING -p tcp -m tcp --dport 11322 -j DNAT --to-destination 172.16.0.113:22
-A PREROUTING -p tcp -m tcp --dport 55513 -j DNAT --to-destination 172.16.0.113:5901
-A PREROUTING -p tcp -m tcp --dport 11422 -j DNAT --to-destination 172.16.0.114:22
-A PREROUTING -p tcp -m tcp --dport 55514 -j DNAT --to-destination 172.16.0.114:5901
-A PREROUTING -p tcp -m tcp --dport 11522 -j DNAT --to-destination 172.16.0.115:22
-A PREROUTING -p tcp -m tcp --dport 55515 -j DNAT --to-destination 172.16.0.115:5901
-A PREROUTING -p tcp -m tcp --dport 11622 -j DNAT --to-destination 172.16.0.116:22
-A PREROUTING -p tcp -m tcp --dport 55516 -j DNAT --to-destination 172.16.0.116:5901
-A PREROUTING -p tcp -m tcp --dport 12122 -j DNAT --to-destination 172.16.0.121:22
-A PREROUTING -p tcp -m tcp --dport 55521 -j DNAT --to-destination 172.16.0.121:5901
-A PREROUTING -p tcp -m tcp --dport 12222 -j DNAT --to-destination 172.16.0.122:22
-A PREROUTING -p tcp -m tcp --dport 55522 -j DNAT --to-destination 172.16.0.122:5901
-A PREROUTING -p tcp -m tcp --dport 12322 -j DNAT --to-destination 172.16.0.123:22
-A PREROUTING -p tcp -m tcp --dport 55523 -j DNAT --to-destination 172.16.0.123:5901
-A PREROUTING -p tcp -m tcp --dport 12422 -j DNAT --to-destination 172.16.0.124:22
-A PREROUTING -p tcp -m tcp --dport 55524 -j DNAT --to-destination 172.16.0.124:5901
-A PREROUTING -p tcp -m tcp --dport 12522 -j DNAT --to-destination 172.16.0.125:22
-A PREROUTING -p tcp -m tcp --dport 55525 -j DNAT --to-destination 172.16.0.125:5901
-A PREROUTING -p tcp -m tcp --dport 12622 -j DNAT --to-destination 172.16.0.126:22
-A PREROUTING -p tcp -m tcp --dport 55526 -j DNAT --to-destination 172.16.0.126:5901
-A PREROUTING -p tcp -m tcp --dport 12722 -j DNAT --to-destination 172.16.0.127:22
-A PREROUTING -p tcp -m tcp --dport 55527 -j DNAT --to-destination 172.16.0.127:5901
-A PREROUTING -p tcp -m tcp --dport 12822 -j DNAT --to-destination 172.16.0.128:22
-A PREROUTING -p tcp -m tcp --dport 55528 -j DNAT --to-destination 172.16.0.128:5901
-A PREROUTING -p tcp -m tcp --dport 12922 -j DNAT --to-destination 172.16.0.129:22
-A PREROUTING -p tcp -m tcp --dport 55529 -j DNAT --to-destination 172.16.0.129:5901
-A PREROUTING -p tcp -m tcp --dport 13022 -j DNAT --to-destination 172.16.0.130:22
-A PREROUTING -p tcp -m tcp --dport 55530 -j DNAT --to-destination 172.16.0.130:5901
-A PREROUTING -p tcp -m tcp --dport 13122 -j DNAT --to-destination 172.16.0.131:22
-A PREROUTING -p tcp -m tcp --dport 55531 -j DNAT --to-destination 172.16.0.131:5901
-A PREROUTING -p tcp -m tcp --dport 13222 -j DNAT --to-destination 172.16.0.132:22
-A PREROUTING -p tcp -m tcp --dport 55532 -j DNAT --to-destination 172.16.0.132:5901
-A PREROUTING -p tcp -m tcp --dport 13322 -j DNAT --to-destination 172.16.0.133:22
-A PREROUTING -p tcp -m tcp --dport 55533 -j DNAT --to-destination 172.16.0.133:5901
-A PREROUTING -p tcp -m tcp --dport 13422 -j DNAT --to-destination 172.16.0.134:22
-A PREROUTING -p tcp -m tcp --dport 55534 -j DNAT --to-destination 172.16.0.134:5902
-A PREROUTING -p tcp -m tcp --dport 13522 -j DNAT --to-destination 172.16.0.135:22
-A PREROUTING -p tcp -m tcp --dport 55535 -j DNAT --to-destination 172.16.0.135:5901
-A PREROUTING -p tcp -m tcp --dport 13622 -j DNAT --to-destination 172.16.0.136:22
-A PREROUTING -p tcp -m tcp --dport 55536 -j DNAT --to-destination 172.16.0.136:5901
-A PREROUTING -p tcp -m tcp --dport 13722 -j DNAT --to-destination 172.16.0.137:22
-A PREROUTING -p tcp -m tcp --dport 55537 -j DNAT --to-destination 172.16.0.137:5901
-A PREROUTING -p tcp -m tcp --dport 13822 -j DNAT --to-destination 172.16.0.138:22
-A PREROUTING -p tcp -m tcp --dport 55538 -j DNAT --to-destination 172.16.0.138:5901
-A PREROUTING -p tcp -m tcp --dport 13922 -j DNAT --to-destination 172.16.0.139:22
-A PREROUTING -p tcp -m tcp --dport 55539 -j DNAT --to-destination 172.16.0.139:5901
-A PREROUTING -p tcp -m tcp --dport 11822 -j DNAT --to-destination 172.16.0.118:22
-A PREROUTING -p tcp -m tcp --dport 55518 -j DNAT --to-destination 172.16.0.118:5901
-A PREROUTING -p tcp -m tcp --dport 22022 -j DNAT --to-destination 172.16.0.200:22
-A PREROUTING -p tcp -m tcp --dport 55550 -j DNAT --to-destination 172.16.0.200:5901
-A PREROUTING -p tcp -m tcp --dport 51135 -j DNAT --to-destination 172.16.0.201:135
-A PREROUTING -p tcp -m tcp --dport 52019 -j DNAT --to-destination 172.16.0.201:3389
-A PREROUTING -p tcp -m tcp --dport 52029 -j DNAT --to-destination 172.16.0.202:3389
-A PREROUTING -p tcp -m tcp --dport 52039 -j DNAT --to-destination 172.16.0.203:3389
-A PREROUTING -p tcp -m tcp --dport 52049 -j DNAT --to-destination 172.16.0.204:3389
-A PREROUTING -p tcp -m tcp --dport 52129 -j DNAT --to-destination 172.16.0.212:3389
-A PREROUTING -p tcp -m tcp --dport 52219 -j DNAT --to-destination 172.16.0.221:3389
-A PREROUTING -p tcp -m tcp --dport 52239 -j DNAT --to-destination 172.16.0.223:3389
-A PREROUTING -p tcp -m tcp --dport 21122 -j DNAT --to-destination 172.16.0.11:22
-A PREROUTING -p tcp -m tcp --dport 55901 -j DNAT --to-destination 172.16.0.11:5901
-A POSTROUTING -d 172.16.0.11/32 -p tcp -m tcp -j SNAT --to-source 172.16.0.1
-A POSTROUTING -d 172.16.0.101/32 -p tcp -m tcp -j SNAT --to-source 172.16.0.1
-A POSTROUTING -d 172.16.0.102/32 -p tcp -m tcp -j SNAT --to-source 172.16.0.1
-A POSTROUTING -d 172.16.0.103/32 -p tcp -m tcp -j SNAT --to-source 172.16.0.1
-A POSTROUTING -d 172.16.0.104/32 -p tcp -m tcp -j SNAT --to-source 172.16.0.1
-A POSTROUTING -d 172.16.0.105/32 -p tcp -m tcp -j SNAT --to-source 172.16.0.1
-A POSTROUTING -d 172.16.0.106/32 -p tcp -m tcp -j SNAT --to-source 172.16.0.1
-A POSTROUTING -d 172.16.0.107/32 -p tcp -m tcp -j SNAT --to-source 172.16.0.1
-A POSTROUTING -d 172.16.0.108/32 -p tcp -m tcp -j SNAT --to-source 172.16.0.1
-A POSTROUTING -d 172.16.0.109/32 -p tcp -m tcp -j SNAT --to-source 172.16.0.1
-A POSTROUTING -d 172.16.0.110/32 -p tcp -m tcp -j SNAT --to-source 172.16.0.1
-A POSTROUTING -d 172.16.0.111/32 -p tcp -m tcp -j SNAT --to-source 172.16.0.1
-A POSTROUTING -d 172.16.0.112/32 -p tcp -m tcp -j SNAT --to-source 172.16.0.1
-A POSTROUTING -d 172.16.0.113/32 -p tcp -m tcp -j SNAT --to-source 172.16.0.1
-A POSTROUTING -d 172.16.0.114/32 -p tcp -m tcp -j SNAT --to-source 172.16.0.1
-A POSTROUTING -d 172.16.0.115/32 -p tcp -m tcp -j SNAT --to-source 172.16.0.1
-A POSTROUTING -d 172.16.0.116/32 -p tcp -m tcp -j SNAT --to-source 172.16.0.1
-A POSTROUTING -d 172.16.0.121/32 -p tcp -m tcp -j SNAT --to-source 172.16.0.1
-A POSTROUTING -d 172.16.0.122/32 -p tcp -m tcp -j SNAT --to-source 172.16.0.1
-A POSTROUTING -d 172.16.0.123/32 -p tcp -m tcp -j SNAT --to-source 172.16.0.1
-A POSTROUTING -d 172.16.0.124/32 -p tcp -m tcp -j SNAT --to-source 172.16.0.1
-A POSTROUTING -d 172.16.0.125/32 -p tcp -m tcp -j SNAT --to-source 172.16.0.1
-A POSTROUTING -d 172.16.0.126/32 -p tcp -m tcp -j SNAT --to-source 172.16.0.1
-A POSTROUTING -d 172.16.0.127/32 -p tcp -m tcp -j SNAT --to-source 172.16.0.1
-A POSTROUTING -d 172.16.0.128/32 -p tcp -m tcp -j SNAT --to-source 172.16.0.1
-A POSTROUTING -d 172.16.0.129/32 -p tcp -m tcp -j SNAT --to-source 172.16.0.1
-A POSTROUTING -d 172.16.0.130/32 -p tcp -m tcp -j SNAT --to-source 172.16.0.1
-A POSTROUTING -d 172.16.0.131/32 -p tcp -m tcp -j SNAT --to-source 172.16.0.1
-A POSTROUTING -d 172.16.0.132/32 -p tcp -m tcp -j SNAT --to-source 172.16.0.1
-A POSTROUTING -d 172.16.0.133/32 -p tcp -m tcp -j SNAT --to-source 172.16.0.1
-A POSTROUTING -d 172.16.0.134/32 -p tcp -m tcp -j SNAT --to-source 172.16.0.1
-A POSTROUTING -d 172.16.0.135/32 -p tcp -m tcp -j SNAT --to-source 172.16.0.1
-A POSTROUTING -d 172.16.0.136/32 -p tcp -m tcp -j SNAT --to-source 172.16.0.1
-A POSTROUTING -d 172.16.0.137/32 -p tcp -m tcp -j SNAT --to-source 172.16.0.1
-A POSTROUTING -d 172.16.0.138/32 -p tcp -m tcp -j SNAT --to-source 172.16.0.1
-A POSTROUTING -d 172.16.0.139/32 -p tcp -m tcp -j SNAT --to-source 172.16.0.1
-A POSTROUTING -d 172.16.0.118/32 -p tcp -m tcp -j SNAT --to-source 172.16.0.1
-A POSTROUTING -d 172.16.0.119/32 -p tcp -m tcp -j SNAT --to-source 172.16.0.1
-A POSTROUTING -d 172.16.0.200/32 -p tcp -m tcp -j SNAT --to-source 172.16.0.1
-A POSTROUTING -d 172.16.0.201/32 -p tcp -m tcp -j SNAT --to-source 172.16.0.1
-A POSTROUTING -d 172.16.0.202/32 -p tcp -m tcp -j SNAT --to-source 172.16.0.1
-A POSTROUTING -d 172.16.0.203/32 -p tcp -m tcp -j SNAT --to-source 172.16.0.1
-A POSTROUTING -d 172.16.0.204/32 -p tcp -m tcp -j SNAT --to-source 172.16.0.1
-A POSTROUTING -d 172.16.0.221/32 -p tcp -m tcp -j SNAT --to-source 172.16.0.1
-A POSTROUTING -d 172.16.0.222/32 -p tcp -m tcp -j SNAT --to-source 172.16.0.1
-A POSTROUTING -d 172.16.0.223/32 -p tcp -m tcp -j SNAT --to-source 172.16.0.1
-A POSTROUTING -d 172.16.0.224/32 -p tcp -m tcp -j SNAT --to-source 172.16.0.1

-A POSTROUTING -o enp11s0f0 -j MASQUERADE
COMMIT
# Completed on Tue Sep 26 17:38:54 2017
# Generated by iptables-save v1.4.21 on Tue Sep 26 17:38:54 2017
*filter
:INPUT ACCEPT [4766185:6966734269]
:FORWARD ACCEPT [96785635:138907095405]
:OUTPUT ACCEPT [2903092:8043050648]
COMMIT
# Completed on Tue Sep 26 17:38:54 2017


```
